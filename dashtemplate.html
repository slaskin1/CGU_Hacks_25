<!doctype html>
<html lang="en">
  <head>
    <title>Route 16 Employee Dashboard</title>

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Plotly JS -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

    <style>
      :root {
        --brand-red: #b40123;
      }

      /* Make all Bootstrap primary elements = red */
      .btn-primary,
      .btn-primary:hover,
      .btn-primary:focus {
        background-color: var(--brand-red) !important;
        border-color: var(--brand-red) !important;
      }

      /* Make tabs match brand red */
      .nav-tabs .nav-link.active {
        color: var(--brand-red) !important;
        border-color: var(--brand-red) var(--brand-red) #fff !important;
      }
      .nav-tabs .nav-link {
        color: var(--brand-red) !important;
      }

      /* Plotly color override */
      .js-plotly-plot .plotly .main-svg {
        color: var(--brand-red) !important;
      }

      /* Header adjustments */
      .dashboard-title {
        color: var(--brand-red);
        font-weight: 800;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 3.2rem;   /* Smaller than your original 5rem */
      }
    </style>
  </head>

  <body class="bg-light" style="font-family: serif;">

    <!-- HEADER ROW: logo + title inline -->
    <div class="container-fluid py-4 d-flex align-items-center justify-content-center">
      <img 
        src="{{ url_for('static', filename='logo.png') }}" 
        alt="Route 16 Logo"
        style="height: 80px; margin-right: 20px;"
      >
      <h1 class="mb-0 dashboard-title">
        Route 16 Employee Dashboard
      </h1>
    </div>

    <!-- Tabs -->
    <ul class="nav nav-tabs mb-3">
      <li class="nav-item">
        <a
          class="nav-link {% if view == 'worker' %}active{% endif %}"
          href="{{ url_for('worker_dashboard', employee=selected_employee, wave=selected_wave) }}"
        >
          Worker View
        </a>
      </li>
      <li class="nav-item">
        <a
          class="nav-link {% if view == 'supervisor' %}active{% endif %}"
          href="{{ url_for('supervisor_dashboard', supervisor=selected_supervisor, wave=selected_wave) }}"
        >
          Supervisor View
        </a>
      </li>
    </ul>

    {% if view == 'worker' %}
    <!-- ============= WORKER VIEW ============= -->

    <form method="get" action="{{ url_for('worker_dashboard') }}" class="mb-4">
      <div class="row g-3 justify-content-center">
        <div class="col-md-4">
          <label class="form-label">Employee</label>
          <select name="employee" class="form-select">
            {% for name in employee_names %}
            <option
              value="{{ name }}"
              {% if name == selected_employee %}selected{% endif %}
            >
              {{ name }}
            </option>
            {% endfor %}
          </select>
        </div>

        <div class="col-md-3">
          <label class="form-label">Wave (for Skill Profile)</label>
          <select name="wave" class="form-select">
            {% for w in wave_labels %}
            <option value="{{ w }}" {% if w == selected_wave %}selected{% endif %}>
              {{ w }}
            </option>
            {% endfor %}
          </select>
        </div>

        <div class="col-md-2 d-flex align-items-end">
          <button type="submit" class="btn btn-primary w-100">Update</button>
        </div>
      </div>
    </form>

    <div class="row mb-4">
      <div class="col-md-6">
        <div class="card shadow-sm">
          <div class="card-header">Employee Skill Profile</div>
          <div class="card-body">
            {{ emp_radar_div|safe }}
          </div>
        </div>
      </div>

      <div class="col-md-6 mt-3 mt-md-0">
        <div class="card shadow-sm">
          <div class="card-header">Employee Average Skill Score Over Waves</div>
          <div class="card-body">
            {{ emp_ts_div|safe }}
          </div>
        </div>
      </div>
    </div>

    {% elif view == 'supervisor' %}
    <!-- ============= SUPERVISOR VIEW ============= -->

    <form method="get" action="{{ url_for('supervisor_dashboard') }}" class="mb-4">
      <div class="row g-3 justify-content-center">
        <div class="col-md-4">
          <label class="form-label">Supervisor</label>
          <select name="supervisor" class="form-select">
            {% for sup in supervisor_names %}
            <option
              value="{{ sup }}"
              {% if sup == selected_supervisor %}selected{% endif %}
            >
              {{ sup }}
            </option>
            {% endfor %}
          </select>
        </div>

        <div class="col-md-3">
          <label class="form-label">Wave (for Skill Profile)</label>
          <select name="wave" class="form-select">
            {% for w in wave_labels %}
            <option value="{{ w }}" {% if w == selected_wave %}selected{% endif %}>
              {{ w }}
            </option>
            {% endfor %}
          </select>
        </div>

        <div class="col-md-2 d-flex align-items-end">
          <button type="submit" class="btn btn-primary w-100">Update</button>
        </div>
      </div>
    </form>

    <div class="row mb-4">
      <div class="col-md-6">
        <div class="card shadow-sm">
          <div class="card-header">
            Supervisor View – Shaded Radar (All Direct Reports)
          </div>
          <div class="card-body">
            {{ sup_radar_div|safe }}
          </div>
        </div>
      </div>

      <div class="col-md-6 mt-3 mt-md-0">
        <div class="card shadow-sm">
          <div class="card-header">
            Supervisor View – Average Scores Over Waves
          </div>
          <div class="card-body">
            {{ sup_ts_div|safe }}
          </div>
        </div>
      </div>
    </div>

    {% endif %}
  </body>
</html>
